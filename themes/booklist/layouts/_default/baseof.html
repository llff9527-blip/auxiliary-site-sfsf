<!DOCTYPE html>
<html lang="{{ .Site.Language.Lang }}">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ block "title" . }}{{ .Title }} - {{ .Site.Title }}{{ end }}</title>
    <meta name="description" content="{{ .Description | default .Summary | plainify }}">

    <!-- SEO Meta Tags -->
    <meta property="og:title" content="{{ .Title }}">
    <meta property="og:description" content="{{ .Description | default .Summary | plainify }}">
    <meta property="og:type" content="article">
    <meta property="og:url" content="{{ .Permalink }}">
    {{ with .Params.image }}<meta property="og:image" content="{{ . | absURL }}">{{ end }}

    <!-- Schema.org JSON-LD for ItemList (书单列表) -->
    {{ if .IsPage }}{{ if eq .Type "lists" }}
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "ItemList",
      "name": "{{ .Title }}",
      "description": "{{ .Description | default .Summary | plainify }}",
      "numberOfItems": {{ len .Params.books }},
      "itemListElement": [
        {{ range $index, $book := .Params.books }}
        {
          "@type": "ListItem",
          "position": {{ add $index 1 }},
          "item": {
            "@type": "Book",
            "name": "{{ $book.title }}",
            {{ with $book.author }}"author": {
              "@type": "Person",
              "name": "{{ . }}"
            },{{ end }}
            {{ with $book.isbn }}"isbn": "{{ . }}",{{ end }}
            {{ with $book.description }}"description": {{ . | plainify | jsonify }}{{ end }}
          }
        }{{ if ne $index (sub (len $.Params.books) 1) }},{{ end }}
        {{ end }}
      ]
    }
    </script>

    <!-- Collection Schema -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Collection",
      "name": "{{ .Title }}",
      "description": "{{ .Description | default .Summary | plainify }}",
      "collectionSize": {{ len .Params.books }},
      "about": {
        "@type": "Thing",
        "name": "{{ .Params.category | default "图书推荐" }}"
      }
    }
    </script>

    <!-- Article Schema for SEO -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Article",
      "headline": "{{ .Title }}",
      "datePublished": "{{ .Date.Format "2006-01-02T15:04:05Z07:00" }}",
      "dateModified": "{{ .Lastmod.Format "2006-01-02T15:04:05Z07:00" }}",
      "author": {
        "@type": "Person",
        "name": "{{ .Site.Params.author | default "站点作者" }}"
      },
      "publisher": {
        "@type": "Organization",
        "name": "{{ .Site.Title }}",
        "logo": {
          "@type": "ImageObject",
          "url": "{{ .Site.Params.logo | default "/logo.png" | absURL }}"
        }
      },
      "description": "{{ .Description | default .Summary | plainify }}",
      "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "{{ .Permalink }}"
      }
    }
    </script>
    {{ end }}{{ end }}

    <!-- Stylesheet -->
    <link rel="stylesheet" href="{{ "css/style.css" | relURL }}">

    <!-- Canonical URL -->
    <link rel="canonical" href="{{ .Permalink }}">
</head>
<body>
    {{ partial "header.html" . }}

    <main>
        {{ block "main" . }}{{ end }}
    </main>

    {{ partial "footer.html" . }}
</body>
</html>
